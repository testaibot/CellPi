
```{r}
#load to seurat
my_data_init <- merge_splits(curr_proc4)
seur <- seur_find_multiplication(CreateSeuratObject(raw.data = my_data_init), regress_cc_diff = T)
```

```{r}
curr <- seur
#analyse current split
table(get_orig_ident(curr), get_ident(curr))
plot_tsn(curr)
plot_pca(curr)
  
cl_markers <- find_markers(curr, test.use = "MAST", max.cells.per.ident = 100, logfc.threshold = 0.5, only.pos = T)
plot_venn(cl_markers)
lapply(1:length(cl_markers$cluster.markers), function(i){return (array(gene_annot_convert_to(rownames(cl_markers$cluster.markers[i]$ident), "symbol")$new))})

#test GO, default params
GO_enr(cl_markers)
```

```{r}
#get sub-cluster split
seur_0 <- seur_find_multiplication(seur, cluster = "0", regress_cc_diff = T)

#go to prev chunk
#curr <- seur_1

```



```{r}

par( mfrow = c(1,1))
for(gene in intersect(rownames(cl_markers$cluster.markers[1]$ident),  markers))
{
  FeaturePlot(object = curr, reduction.use = "tsne", features.plot = gene, cols.use = c("red", "green"))
}

```



