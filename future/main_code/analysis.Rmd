


```{r}
#matrix preprocessing
mtx = Matrix(as.matrix(senic_tm),sparse = T)
mtx = filter_mtx(mtx)
rownames(mtx) = sapply(strsplit(rownames(mtx),"_"),function(x){x[[2]]})

#load cluster annotation
obj_cl = senic_tm_an[,2:3]
rownames(obj_cl) = senic_tm_an[,1]
obj_cl = obj_cl[colnames(mtx),]
```


```{r}
#remove raw data
# rm(ESCdata)
# rm(ESCannotations)
```


```{r}
#load matrix and annotation to Seurat
obj = seur_create(mtx)
obj@meta.data[["orig.ident"]] = factor(obj_cl[,1])
obj@meta.data[["orig.ident1"]] = factor(obj_cl[,2])
```


```{r}
rm("tf", "senic_tm", "senic_tm_an", "mtx", "obj_cl")
```


